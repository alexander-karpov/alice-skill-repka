import { mainDialog } from './dialog';
import { spawnMystem, Stemmer } from './stemmer';
import { SessionData, createSessionData } from './sessionData';

describe('Main dialog', () => {
    test('ÐšÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐºÐ°Ð·ÐºÐ°: Ð½Ð°Ñ‡Ð°Ð»Ð¾', async () => {
        expect(await act('')).toMatch('Ð¾ÑÐ°Ð´Ð¸Ð» Ð´ÐµÐ´ Ñ€ÐµÐ¿ÐºÑƒ');
    });

    test('ÐšÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐºÐ°Ð·ÐºÐ°: Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ', async () => {
        act('');
        act('Ð‘Ð°Ð±ÐºÑƒ');
        act('Ð’Ð½ÑƒÑ‡ÐºÑƒ');
        act('Ð–ÑƒÑ‡ÐºÑƒ');
        const story = await act('ÐšÐ¾ÑˆÐºÑƒ');

        expect(story).toMatch('ÐšÐ¾ÑˆÐºÐ° ðŸ± Ð·Ð° Ð¶ÑƒÑ‡ÐºÑƒ, Ð¶ÑƒÑ‡ÐºÐ° ðŸ¶ Ð·Ð° Ð²Ð½ÑƒÑ‡ÐºÑƒ, Ð²Ð½ÑƒÑ‡ÐºÐ° ðŸ‘§ Ð·Ð° Ð±Ð°Ð±ÐºÑƒ,');
        expect(story).toMatch(
            'Ð±Ð°Ð±ÐºÐ° ðŸ‘µ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ, Ð´ÐµÐ´ÐºÐ° ðŸ‘´ Ð·Ð° Ñ€ÐµÐ¿ÐºÑƒ. Ð¢ÑÐ½ÑƒÑ‚-Ð¿Ð¾Ñ‚ÑÐ½ÑƒÑ‚ â€” Ð²Ñ‹Ñ‚ÑÐ½ÑƒÑ‚ÑŒ Ð½Ðµ Ð¼Ð¾Ð³ÑƒÑ‚.',
        );
    });

    test('ÐšÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ°Ñ ÑÐºÐ°Ð·ÐºÐ°: ÐºÐ¾Ð½ÐµÑ† [Ð¿Ð¾Ð·Ð²Ð°Ð»Ð¸ Ð¼Ñ‹ÑˆÐºÑƒ]', async () => {
        act('');
        act('Ð‘Ð°Ð±ÐºÑƒ');
        const story = await act('ÐœÑ‹ÑˆÐºÑƒ');

        expect(story).toMatch(
            'ÐœÑ‹ÑˆÐºÐ° ðŸ­ Ð·Ð° Ð±Ð°Ð±ÐºÑƒ, Ð±Ð°Ð±ÐºÐ° ðŸ‘µ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ, Ð´ÐµÐ´ÐºÐ° ðŸ‘´ Ð·Ð° Ñ€ÐµÐ¿ÐºÑƒ. Ð¢ÑÐ½ÑƒÑ‚-Ð¿Ð¾Ñ‚ÑÐ½ÑƒÑ‚ ðŸŽ‰ Ð²Ñ‹Ñ‚ÑÐ½ÑƒÐ»Ð¸ Ñ€ÐµÐ¿ÐºÑƒ!',
        );
    });

    test('ÐœÑƒÐ¶ÑÐºÐ¾Ð¹ Ñ€Ð¾Ð´ Ð·Ð¾Ð²ÐµÑ‚ Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ', async () => {
        act('');
        expect(await act('Ð”Ñ€Ð°ÐºÐ¾Ð½Ð°')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð» Ð´Ñ€Ð°ÐºÐ¾Ð½');
    });

    test('Ð–ÐµÐ½ÑÐºÐ¸Ð¹ Ñ€Ð¾Ð´ Ð·Ð¾Ð²ÐµÑ‚ Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ', async () => {
        act('');
        expect(await act('Ð‘Ð°Ð±ÐºÑƒ')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð»Ð° Ð±Ð°Ð±ÐºÐ°');
    });

    test('Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ñ€Ð¾Ð´ Ð·Ð¾Ð²ÐµÑ‚ Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ', async () => {
        act('');
        expect(await act('Ð§ÑƒÐ´Ð¸Ñ‰Ðµ')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð»Ð¾ Ñ‡ÑƒÐ´Ð¸Ñ‰Ðµ');
    });

    test('Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð³ÐµÑ€Ð¾Ñ Ð² Ñ‚Ð²Ð¾Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¼ Ð¿Ð°Ð´ÐµÐ¶Ðµ', async () => {
        act('');
        expect(await act('Ð‘ÑƒÑ‚Ñ‹Ð»ÐºÐ° ÑÑ‚Ð¾Ð»Ð° Ð´Ñ€Ð°ÐºÐ¾Ð½Ð°')).toMatch('Ð”Ñ€Ð°ÐºÐ¾Ð½ ðŸ‰ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
    });

    test('ÐŸÑ€ÐµÐ´Ð¿Ð¾Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ Ð¾Ð´ÑƒÑˆÐµÐ²Ð»ÐµÐ½Ð½Ñ‹Ð¼', async () => {
        act('');
        expect(await act('Ð¡ÐµÑ€Ñ‘Ð¶ÐºÑƒ')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð» ÑÐµÑ€ÐµÐ¶ÐºÐ°');
    });

    test('ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ ÑÐºÐ»Ð¾Ð½ÑÐµÑ‚ Ñ„Ñ€Ð°Ð·Ñƒ Ð¿ÐµÑ€ÐµÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð½Ð¸Ñ Ð³ÐµÑ€Ð¾Ñ', async () => {
        act('');
        act('Ð²Ð½ÑƒÐºÐ°');
        expect(await act('Ñ€Ð°ÐºÐµÑ‚Ð°')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð» Ð²Ð½ÑƒÐº');

        act('Ð‘Ð°Ð±ÐºÑƒ');
        expect(await act('Ñ€Ð°ÐºÐµÑ‚Ð°')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð»Ð° Ð±Ð°Ð±ÐºÐ°');

        act('Ñ‡ÑƒÐ´Ð¸Ñ‰Ðµ');
        expect(await act('Ñ€Ð°ÐºÐµÑ‚Ð°')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð»Ð¾ Ñ‡ÑƒÐ´Ð¸Ñ‰Ðµ');
    });

    test('ÐŸÑ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð² Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¼ Ð¿Ð°Ð´ÐµÐ¶Ðµ', async () => {
        act('');
        expect(await act('Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº')).toMatch('Ð§ÐµÐ»Ð¾Ð²ÐµÐº Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('Ð±Ð¾Ð³Ð°Ñ‚Ñ‹Ñ€ÑŒ')).toMatch('Ð‘Ð¾Ð³Ð°Ñ‚Ñ‹Ñ€ÑŒ Ð·Ð° Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°');
        expect(await act('Ð’Ð½ÑƒÑ‡Ð¾Ðº')).toMatch('Ð’Ð½ÑƒÑ‡Ð¾Ðº Ð·Ð° Ð±Ð¾Ð³Ð°Ñ‚Ñ‹Ñ€Ñ');
        expect(await act('Ð¦Ð°Ñ€Ð¸Ñ†Ð°')).toMatch('Ð¦Ð°Ñ€Ð¸Ñ†Ð° Ð·Ð° Ð²Ð½ÑƒÑ‡ÐºÐ°');
        expect(await act('Ð›ÐµÐ±ÐµÐ´ÑŒ')).toMatch('Ð›ÐµÐ±ÐµÐ´ÑŒ ðŸ¦¢ Ð·Ð° Ñ†Ð°Ñ€Ð¸Ñ†Ñƒ');
        // TODO Ð›ÐµÐ±ÐµÐ´ÑŒ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°ÐµÑ‚ÑÑ ÐºÐ°Ðº Ñ„Ð°Ð¼Ð¸Ð»Ð¸Ñ Ð¶ÐµÐ½. Ð² Ð²Ð¸Ð½. Ð¿Ð°Ð´ÐµÐ¶Ðµ
        // expect(await act('Ð’Ñ€Ð°Ñ‡')).toMatch('Ð’Ñ€Ð°Ñ‡ Ð·Ð° Ð»ÐµÐ±ÐµÐ´Ñ');
    });

    test('ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ Ð²Ð¸Ð½. Ð¿Ð°Ð´ÐµÐ¶Ñƒ', async () => {
        /**
         * Ð²Ð½ÑƒÑ‡Ðº+Ð°, Ð° Ð½Ðµ Ð²Ð½+ÑƒÑ‡ÐºÐ°
         * ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð´ÐµÐ´ Ð¿Ð¾Ð·Ð²Ð°Ð» Ð²Ð½ÑƒÑ‡ÐºÐ°
         */
        act('');
        expect(await act('Ð’Ð½ÑƒÑ‡ÐºÐ°')).toMatch('Ð’Ð½ÑƒÑ‡Ð¾Ðº Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
    });

    test('Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ñ„Ñ€Ð°Ð·Ð° Ð´Ð»Ñ Ñ€Ñ‹Ð±ÐºÐ¸', async () => {
        act('');
        expect(await tts('Ð·Ð¾Ð»Ð¾Ñ‚ÑƒÑŽ Ñ€Ñ‹Ð±ÐºÑƒ Ð¸Ð· ÑÐºÐ°Ð·ÐºÐ¸ ÐŸÑƒÑˆÐºÐ¸Ð½Ð°')).toMatch(
            /ÐºÐ»Ð¸ÐºÐ°Ñ‚ÑŒ Ð·Ð¾Ð»Ð¾Ñ‚ÑƒÑŽ Ñ€Ñ‹Ð±ÐºÑƒ.*Ð¿Ñ€Ð¸Ð¿Ð»Ñ‹Ð»Ð° Ðº Ð½ÐµÐ¼Ñƒ Ñ€Ñ‹Ð±ÐºÐ°, ÑÐ¿Ñ€Ð¾ÑÐ¸Ð»Ð°/,
        );

        act('ÐºÐ¾ÑˆÐºÑƒ');
        expect(await act('Ñ€Ñ‹Ð±ÐºÑƒ Ð¸Ð· ÑÐºÐ°Ð·ÐºÐ¸ ÐŸÑƒÑˆÐºÐ¸Ð½Ð°')).toMatch('ÑÑ‚Ð°Ð»Ð° Ð¾Ð½Ð° ÐºÐ»Ð¸ÐºÐ°Ñ‚ÑŒ');
    });

    test('Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ñ„Ñ€Ð°Ð·Ð° Ð´Ð»Ñ ÐºÐ¾ÑˆÐµÐº', async () => {
        act('');
        expect(await tts('Ñ‡ÐµÑ€Ð½ÑƒÑŽ ÐºÐ¾ÑˆÐºÑƒ')).toMatch(/ÐŸÑ€Ð¸Ð±ÐµÐ¶Ð°Ð»Ð° Ñ‡ÐµÑ€Ð½Ð°Ñ ÐºÐ¾ÑˆÐºÐ°.*Ð²Ñ†ÐµÐ¿Ð¸Ð»Ð°ÑÑŒ Ð² Ð´ÐµÐ´ÐºÑƒ/);
        expect(await tts('ÐºÐ¾Ñ‚ Ð¼Ð°Ñ€Ñ‚Ð¾ÑÐºÐ¸Ð½')).toMatch(/ÐŸÑ€Ð¸Ð±ÐµÐ¶Ð°Ð» ÐºÐ¾Ñ‚.*Ð²Ñ†ÐµÐ¿Ð¸Ð»ÑÑ Ð²/);
    });

    test('Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ñ„Ñ€Ð°Ð·Ð° Ð´Ð»Ñ Ð¼ÑƒÑ€ÐºÐ¸', async () => {
        act('');
        expect(await tts('Ð¼ÑƒÑ€ÐºÑƒ')).toMatch(/ÐŸÑ€Ð¸Ð±ÐµÐ¶Ð°Ð»Ð° ÐºÐ¾ÑˆÐºÐ° Ð¼ÑƒÑ€ÐºÐ°/);
    });

    test('ÐžÑ‚Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ Ð½ÐµÐ¾Ð´ÑƒÑˆÐµÐ²Ð»ÐµÐ½Ð½Ð¾Ðµ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ñ„Ñ€Ð°Ð·Ð¾Ð¹', async () => {
        act('');
        expect(await act('Ð»Ð¾Ð¿Ð°Ñ‚Ñƒ')).toMatch(/Ð·Ð²Ð°Ð» Ð´ÐµÐ´ÐºÐ° Ð»Ð¾Ð¿Ð°Ñ‚Ñƒ.*Ð½Ðµ Ð´Ð¾Ð·Ð²Ð°Ð»ÑÑ/);
        expect(await act('Ð²ÐµÐ´Ñ€Ð¾')).toMatch(/Ð·Ð²Ð°Ð» Ð´ÐµÐ´ÐºÐ° Ð²ÐµÐ´Ñ€Ð¾.*Ð½Ðµ Ð´Ð¾Ð·Ð²Ð°Ð»ÑÑ/);
        expect(await act('Ñ‡Ð°Ð¹Ð½Ð¸Ðº')).toMatch(/Ð·Ð²Ð°Ð» Ð´ÐµÐ´ÐºÐ° Ñ‡Ð°Ð¹Ð½Ð¸Ðº.*Ð½Ðµ Ð´Ð¾Ð·Ð²Ð°Ð»ÑÑ/);
        expect(await act('Ð¾ÐºÐ½Ð¾')).toMatch(/Ð·Ð²Ð°Ð» Ð´ÐµÐ´ÐºÐ° Ð¾ÐºÐ½Ð¾.*Ð½Ðµ Ð´Ð¾Ð·Ð²Ð°Ð»ÑÑ/);
    });

    test('Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ ÑƒÐ¼ÐµÐµÑˆÑŒ / Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ', async () => {
        act('');
        expect(await act('Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ ÑƒÐ¼ÐµÐµÑˆÑŒ')).toMatch('Ð²Ð¼ÐµÑÑ‚Ðµ ÑÐ¾Ñ‡Ð¸Ð½Ð¸Ð¼ ÑÐºÐ°Ð·ÐºÑƒ');
        act('ÐºÐ¾ÑˆÐºÑƒ');
        expect(await act('Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ')).toMatch(/Ð²Ð¼ÐµÑÑ‚Ðµ ÑÐ¾Ñ‡Ð¸Ð½Ð¸Ð¼ ÑÐºÐ°Ð·ÐºÑƒ.*ÐºÐ¾ÑˆÐºÐ°/i);
    });

    test('ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸: Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ', async () => {
        act('');
        expect(await act('Ð¼Ñ‹ÑˆÐºÑƒ')).toMatch('Ð²Ñ‹Ñ‚ÑÐ½ÑƒÐ»Ð¸ Ñ€ÐµÐ¿ÐºÑƒ');
        expect(await act('Ð´Ð°Ð²Ð°Ð¹ ÐµÑ‰Ðµ Ñ€Ð°Ð·')).toMatch('Ð¾ÑÐ°Ð´Ð¸Ð» Ð´ÐµÐ´ Ñ€ÐµÐ¿ÐºÑƒ');

        expect(await act('Ð¼Ñ‹ÑˆÐºÑƒ')).toMatch('Ð²Ñ‹Ñ‚ÑÐ½ÑƒÐ»Ð¸ Ñ€ÐµÐ¿ÐºÑƒ');
        expect(await act('Ð´Ð° Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°')).toMatch('ÐŸÐ¾ÑÐ°Ð´Ð¸Ð» Ð´ÐµÐ´ Ñ€ÐµÐ¿ÐºÑƒ');
    });

    test('ÐžÑ‚ÐºÐ°Ð· Ð¾Ñ‚ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ñ ÑÐ»Ð¾Ð²Ð¾Ð¼ ÐÐµ Ð½Ð°Ð´Ð¾', async () => {
        act('');
        // FIXME: Ð•ÑÐ»Ð¸ ÑƒÐ±Ñ€Ð°Ñ‚ÑŒ await, Ñ‚ÐµÑÑ‚ ÑƒÐ¿Ð°Ð´ÐµÑ‚. ÐŸÐ¾Ð½ÑÑ‚ÑŒ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ.
        await act('Ð¼Ñ‹ÑˆÐºÑƒ');
        expect(await act('Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð½Ð°Ð´Ð¾ Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°')).toMatch('ÐºÐ¾Ð½ÐµÑ†');
    });

    test('ÐŸÐ¾Ð·Ð²Ð°Ð»Ð¸ Ð»Ð¾ÑˆÐ°Ð´ÑŒ (Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ñ)', async () => {
        act('');
        expect(await act('Ð»Ð¾ÑˆÐ°Ð´ÑŒ')).toMatch('Ð›Ð¾ÑˆÐ°Ð´ÑŒ ðŸ´ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('Ð»Ð¾ÑˆÐ°Ð´ÑŒ')).toMatch('Ð›Ð¾ÑˆÐ°Ð´ÑŒ ðŸ´ Ð·Ð° Ð»Ð¾ÑˆÐ°Ð´ÑŒ');
    });

    test('Ð”Ð»Ñ Ð¸Ð¼ÐµÐ½ Ð½ÐµÐ¾Ð¿Ñ€ÐµÐ´. Ñ€Ð¾Ð´Ð° Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ Ð¼ÑƒÐ¶ÑÐºÐ¾Ð¹', async () => {
        act('');
        expect(await act('ÑÐ°ÑˆÑƒ')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð» ÑÐ°ÑˆÐ°');
    });

    test('ÐŸÑ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð¸Ð¼Ñ-Ñ„Ð°Ð¼Ð¸Ð»Ð¸ÑŽ', async () => {
        act('');
        expect(await act('Ð°Ð»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð° ÐºÐ°Ñ€Ð¿Ð¾Ð²Ð°')).toMatch(/ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€ ÐšÐ°Ñ€Ð¿Ð¾Ð² Ð·Ð° Ð´ÐµÐ´ÐºÑƒ,/i);
        expect(await act('Ð¸Ñ€Ð¸Ð½Ð° ÐºÐ°Ñ€Ð¿Ð¾Ð²Ð°')).toMatch(/Ð˜Ñ€Ð¸Ð½Ð° ÐšÐ°Ñ€Ð¿Ð¾Ð²Ð° Ð·Ð° ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð° ÐšÐ°Ñ€Ð¿Ð¾Ð²Ð°,/i);
        expect(await act('Ð²Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€ Ð¿ÑƒÑ‚Ð¸Ð½')).toMatch(/Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€ ÐŸÑƒÑ‚Ð¸Ð½ Ð·Ð° Ð˜Ñ€Ð¸Ð½Ñƒ ÐšÐ°Ñ€Ð¿Ð¾Ð²Ñƒ,/i);
        expect(await act('Ð³Ð°Ñ€Ñ€Ð¸ Ð¿Ð¾Ñ‚Ñ‚ÐµÑ€')).toMatch(/Ð“Ð°Ñ€Ñ€Ð¸ ÐŸÐ¾Ñ‚Ñ‚ÐµÑ€ Ð·Ð° Ð’Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€Ð° ÐŸÑƒÑ‚Ð¸Ð½Ð°,/i);
        expect(await act('Ñ„Ñ‘Ð´Ð¾Ñ€ ÐµÐ¼ÐµÐ»ÑŒÑÐ½ÐµÐ½ÐºÐ¾')).toMatch(/Ð¤ÐµÐ´Ð¾Ñ€ Ð•Ð¼ÐµÐ»ÑŒÑÐ½ÐµÐ½ÐºÐ¾ Ð·Ð° Ð“Ð°Ñ€Ñ€Ð¸ ÐŸÐ¾Ñ‚Ñ‚ÐµÑ€Ð°,/i);
        expect(await act('Ð°Ð»Ð»Ñƒ Ð¿ÑƒÐ³Ð°Ñ‡Ñ‘Ð²Ñƒ')).toMatch(/ÐÐ»Ð»Ð° ÐŸÑƒÐ³Ð°Ñ‡ÐµÐ²Ð° Ð·Ð° Ð¤ÐµÐ´Ð¾Ñ€Ð° Ð•Ð¼ÐµÐ»ÑŒÑÐ½ÐµÐ½ÐºÐ¾,/i);
    });

    test('ÐŸÑ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð¿Ñ€Ð¸Ð»Ð°Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ-ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ', async () => {
        act('');
        expect(await act('Ð¶ÐµÐ»ÐµÐ·Ð½Ð¾Ð³Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°')).toMatch('Ð–ÐµÐ»ÐµÐ·Ð½Ñ‹Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÑƒÑŽ ÐºÐ¾ÑˆÐµÑ‡ÐºÑƒ')).toMatch(
            'ÐœÐ°Ð»ÐµÐ½ÑŒÐºÐ°Ñ ÐºÐ¾ÑˆÐµÑ‡ÐºÐ° ðŸ± Ð·Ð° Ð¶ÐµÐ»ÐµÐ·Ð½Ð¾Ð³Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°,',
        );
        expect(await act('Ñ‡ÐµÑ€Ð½ÑƒÑŽ ÐºÐ¾ÑˆÐºÑƒ')).toMatch('Ð§ÐµÑ€Ð½Ð°Ñ ÐºÐ¾ÑˆÐºÐ° ðŸ± Ð·Ð° Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÑƒÑŽ ÐºÐ¾ÑˆÐµÑ‡ÐºÑƒ,');
        expect(await act('Ð»ÐµÑ‚Ð½Ð¸Ð¹ Ð·Ð°Ð¹Ñ‡Ð¸Ðº')).toMatch('Ð›ÐµÑ‚Ð½Ð¸Ð¹ Ð·Ð°Ð¹Ñ‡Ð¸Ðº ðŸ° Ð·Ð° Ñ‡ÐµÑ€Ð½ÑƒÑŽ ÐºÐ¾ÑˆÐºÑƒ,');
        expect(await act('Ð»ÐµÑ‚Ð½ÑŽÑŽ Ð¿Ñ‡ÐµÐ»ÐºÑƒ')).toMatch('Ð›ÐµÑ‚Ð½ÑÑ Ð¿Ñ‡ÐµÐ»ÐºÐ° ðŸ Ð·Ð° Ð»ÐµÑ‚Ð½ÐµÐ³Ð¾ Ð·Ð°Ð¹Ñ‡Ð¸ÐºÐ°,');
        expect(await act('Ð·Ð²ÐµÑ€Ñ')).toMatch('Ð—Ð²ÐµÑ€ÑŒ Ð·Ð° Ð»ÐµÑ‚Ð½ÑŽÑŽ Ð¿Ñ‡ÐµÐ»ÐºÑƒ,');
    });

    test('Ð›ÑŽÐ±Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð²Ð¸Ð½. Ð¿Ð°Ð´ÐµÐ¶Ð° Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ñ‡Ð¸Ñ‚Ð°ÐµÑ‚ Ð˜Ð¼ÐµÐ½Ð¸-Ð¤Ð°Ð¼Ð¸Ð»Ð¸Ð¸ Ð¸Ð¼. Ð¿Ð°Ð´ÐµÐ¶Ð°', async () => {
        act('');
        expect(await act('Ð¿Ð¾Ð·Ð²Ð°Ð» Ð’Ð°ÑÑ ÐŸÑƒÐ¿ÐºÐ¸Ð½ ÐºÐ¾Ñ‚Ð¸ÐºÐ°')).toMatch('ÐšÐ¾Ð³Ð¾ Ð¿Ð¾Ð·Ð²Ð°Ð» ÐºÐ¾Ñ‚Ð¸Ðº');
    });

    test('Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°ÐµÑ‚ Ð˜Ð¼Ñ-Ð¤Ð°Ð¼Ð¸Ð»Ð¸Ñ ÐºÐ¾Ð³Ð´Ð° Ð¸Ð¼Ñ Ð½ÐµÐ¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»Ð°', async () => {
        act('');
        expect(await act('Ð¡Ð°ÑˆÐ° ÐšÐ°Ñ€Ð¿Ð¾Ð²')).toMatch(/Ð¡Ð°ÑˆÐ° ÐšÐ°Ñ€Ð¿Ð¾Ð² Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('ÐžÑ‡ÐµÐ½ÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ðµ ÑÐ»Ð¾Ð²Ð° Ð² Ð²Ð¸Ð½. Ð¿Ð°Ð´ÐµÐ¶Ðµ.', async () => {
        act('');
        expect(await act('Ð¿ÑÐ°')).toMatch('ÐŸÐµÑ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('Ð»ÑŒÐ²Ð°')).toMatch('Ð›ÐµÐ² ðŸ¦ Ð·Ð° Ð¿ÑÐ°');
        expect(await act('ÐºÐ¾Ñ‚Ð¸ÐºÐ°')).toMatch('ÐšÐ¾Ñ‚Ð¸Ðº ðŸ± Ð·Ð° Ð»ÑŒÐ²Ð°');

        expect(await act('Ð¿ÐµÑ')).toMatch('ÐŸÐµÑ Ð·Ð° ÐºÐ¾Ñ‚Ð¸ÐºÐ°');
        expect(await act('Ð»ÐµÐ²')).toMatch('Ð›ÐµÐ² ðŸ¦ Ð·Ð° Ð¿ÑÐ°');
        expect(await act('ÐºÐ¾Ñ‚Ð¸Ðº')).toMatch('ÐšÐ¾Ñ‚Ð¸Ðº ðŸ± Ð·Ð° Ð»ÑŒÐ²Ð°');
    });

    test('ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸: Ð¾Ñ‚ÐºÐ°Ð·', async () => {
        act('');
        expect(await act('Ð¼Ñ‹ÑˆÐºÑƒ')).toMatch('Ð²Ñ‹Ñ‚ÑÐ½ÑƒÐ»Ð¸ Ñ€ÐµÐ¿ÐºÑƒ');
        const {
            speech: { text },
            endSession,
        } = await mainDialog('Ð½ÐµÑ‚ ÑÐ¿Ð°ÑÐ¸Ð±Ð¾', sessionData, { stemmer, random100: 0 });

        expect(text).toMatch('ÐºÐ¾Ð½ÐµÑ†');
        expect(endSession).toEqual(true);
    });

    test('ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð»Ð¸ Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº ÐµÑÐ»Ð¸ Ð½Ðµ Ð´Ð¾Ð¶Ð¸Ð´Ð°Ñ‚ÑŒÑÑ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸', async () => {
        act('');
        act('Ð‘Ð°Ð±ÐºÑƒ');
        act('Ð’Ð½ÑƒÑ‡ÐºÑƒ');
        act('Ð–ÑƒÑ‡ÐºÑƒ');
        const story = await act('ÐšÐ¾ÑˆÐºÑƒ');

        expect(story).toMatch('ÐšÐ¾ÑˆÐºÐ° ðŸ± Ð·Ð° Ð¶ÑƒÑ‡ÐºÑƒ, Ð¶ÑƒÑ‡ÐºÐ° ðŸ¶ Ð·Ð° Ð²Ð½ÑƒÑ‡ÐºÑƒ, Ð²Ð½ÑƒÑ‡ÐºÐ° ðŸ‘§ Ð·Ð° Ð±Ð°Ð±ÐºÑƒ,');
        expect(story).toMatch(
            'Ð±Ð°Ð±ÐºÐ° ðŸ‘µ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ, Ð´ÐµÐ´ÐºÐ° ðŸ‘´ Ð·Ð° Ñ€ÐµÐ¿ÐºÑƒ. Ð¢ÑÐ½ÑƒÑ‚-Ð¿Ð¾Ñ‚ÑÐ½ÑƒÑ‚ â€” Ð²Ñ‹Ñ‚ÑÐ½ÑƒÑ‚ÑŒ Ð½Ðµ Ð¼Ð¾Ð³ÑƒÑ‚.',
        );
    });

    test('Ð¡Ð¿ÐµÑ†Ñ„Ñ€Ð°Ð·Ð° Ð´Ð»Ñ Ð¶ÑƒÑ‡ÐºÐ¸', async () => {
        act('');
        expect(await tts('Ð¶ÑƒÑ‡ÐºÑƒ')).toMatch('ÐŸÑ€Ð¸Ð±ÐµÐ¶Ð°Ð»Ð° Ð¶ÑƒÑ‡ÐºÐ°');
    });

    test('ÐŸÐ¾Ð·Ð²Ð°Ð»Ð¸ Ð±ÑƒÑ€Ð°Ñ‚Ð¸Ð½Ð¾, Ð¿Ð¸Ð½Ð¾ÐºÐºÐ¸Ð¾', async () => {
        act('');
        expect(await act('Ð±ÑƒÑ€Ð°Ñ‚Ð¸Ð½Ð¾')).toMatch('Ð‘ÑƒÑ€Ð°Ñ‚Ð¸Ð½Ð¾ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('Ð¿Ð¸Ð½Ð¾ÐºÐºÐ¸Ð¾')).toMatch('ÐŸÐ¸Ð½Ð¾ÐºÐºÐ¸Ð¾ Ð·Ð° Ð±ÑƒÑ€Ð°Ñ‚Ð¸Ð½Ð¾,');
        expect(await act('ÐºÐ¾Ñ‚Ð¸Ðº')).toMatch('ÐšÐ¾Ñ‚Ð¸Ðº ðŸ± Ð·Ð° Ð¿Ð¸Ð½Ð¾ÐºÐºÐ¸Ð¾,');
    });

    test('Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°ÐµÑ‚ Ð¼Ð½Ð¾Ð¶. Ñ‡Ð¸ÑÐ»Ð¾ ÐºÐ°Ðº ÐµÐ´.', async () => {
        act('');
        expect(await act('ÐºÐ¾ÑˆÐµÐº')).toMatch('ÐšÐ¾ÑˆÐºÐ° ðŸ± Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('ÐºÐ¾Ñ‚ÑÑ‚Ð°')).toMatch('ÐšÐ¾Ñ‚ÐµÐ½Ð¾Ðº ðŸ± Ð·Ð° ÐºÐ¾ÑˆÐºÑƒ');
    });

    test('ÐŸÐ¾Ð·Ð²Ð°Ð»Ð¸ Ð¾ÑÐ»Ð°', async () => {
        act('');
        expect(await act('Ð¾ÑÐ»Ð°')).toMatch('ÐžÑÐµÐ» Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('ÐºÐ¾Ñ‚Ð¸ÐºÐ°')).toMatch('ÐšÐ¾Ñ‚Ð¸Ðº ðŸ± Ð·Ð° Ð¾ÑÐ»Ð°,');
    });

    test('ÐŸÐ¾Ð·Ð²Ð°Ð»Ð¸ Ð³Ð¾Ð½Ñ†Ð°', async () => {
        act('');
        expect(await act('Ð³Ð¾Ð½Ñ†Ð°')).toMatch('Ð“Ð¾Ð½ÐµÑ† Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('ÐºÐ¾Ñ‚Ð¸ÐºÐ°')).toMatch('ÐšÐ¾Ñ‚Ð¸Ðº ðŸ± Ð·Ð° Ð³Ð¾Ð½Ñ†Ð°,');
    });

    test('ÐŸÐ¾Ð·Ð²Ð°Ð»Ð¸ Ð±Ð¾Ð±Ñ€Ð°', async () => {
        act('');
        expect(await act('Ð±Ð¾Ð±Ñ€Ð°')).toMatch('Ð‘Ð¾Ð±ÐµÑ€ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ');
        expect(await act('ÐºÐ¾Ñ‚Ð¸ÐºÐ°')).toMatch('ÐšÐ¾Ñ‚Ð¸Ðº ðŸ± Ð·Ð° Ð±Ð¾Ð±Ñ€Ð°,');
    });

    test('Ð§Ñ‘Ñ€Ð½Ñ‹Ð¹ Ð²Ð¾Ñ€Ð¾Ð½ Ð½Ðµ Ð·Ð°Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ð½Ð° Ð²Ð¾Ñ€Ð¾Ð½Ñƒ', async () => {
        act('');
        expect(await tts('Ñ‡Ñ‘Ñ€Ð½Ð¾Ð³Ð¾ Ð²Ð¾Ñ€Ð¾Ð½Ð°')).toMatch(/ÐŸÑ€Ð¸Ð»ÐµÑ‚ÐµÐ» Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð¾Ñ€Ð¾Ð½ .*Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð¾Ñ€Ð¾Ð½ Ð·Ð°/i);
        expect(await tts('Ñ‡Ñ‘Ñ€Ð½Ñ‹Ð¹ Ð²Ð¾Ñ€Ð¾Ð½')).toMatch(/ÐŸÑ€Ð¸Ð»ÐµÑ‚ÐµÐ» Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð¾Ñ€Ð¾Ð½ .*Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð²Ð¾Ñ€Ð¾Ð½ Ð·Ð°/i);
    });

    test('ÐÐµ ÑÐºÐ»Ð¾Ð½ÑÐµÑ‚ Ð½ÐµÐ¾Ð´. ÑÑƒÑ‰Ð½Ð¾ÑÑ‚Ð¸', async () => {
        act('');
        expect(await tts('Ð·Ð°Ð¼Ð¾Ðº')).toMatch(/Ð·Ð²Ð°Ð» Ð´ÐµÐ´ÐºÐ° Ð·Ð°Ð¼Ð¾Ðº/i);
    });

    test('ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ ÑÐºÐ»Ð¾Ð½ÑÐµÑ‚ Ð¼Ð¸Ð»Ñ‹Ñ… ÐºÐ¾Ð½ÐµÑ†', async () => {
        act('');
        expect(await act('Ð¼Ð¸Ð»Ñ‹Ðµ ÐºÐ¾Ð½Ð¸')).toMatch(/Ð¼Ð¸Ð»Ñ‹Ð¹ ÐºÐ¾Ð½ÑŒ ðŸ´ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
        expect(await act('Ð¼Ð¸Ð»Ñ‹Ðµ ÐºÐ¾Ð½Ð¸')).toMatch(/Ð¼Ð¸Ð»Ñ‹Ð¹ ÐºÐ¾Ð½ÑŒ ðŸ´ Ð·Ð° Ð¼Ð¸Ð»Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ/i);
    });

    test('Ð’ ÐºÐ¾Ð½Ñ†Ðµ ÐºÐ¾Ð½Ñ†Ð¾Ð² Ñ€Ð°ÑÐ¿Ð¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ ÑÑƒÑ‰. Ð² Ð»ÑŽÐ±Ð¾Ð¼ Ð¿Ð°Ð´ÐµÐ¶Ðµ', async () => {
        act('');
        expect(await tts('Ð¼Ð°Ð»ÑŒÑ‡Ð¸ÐºÑƒ')).toMatch(/Ð¼Ð°Ð»ÑŒÑ‡Ð¸Ðº Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('Ð§ÐµÑ€Ð½Ð¸Ð»Ð° - Ð½ÐµÐ¾Ð´ÑƒÑ‰ÐµÐ²Ð»ÐµÐ½Ð½Ð°Ñ ÑÑƒÑ‰Ð½Ð¾ÑÑ‚ÑŒ', async () => {
        act('');
        expect(await tts('Ñ‡ÐµÑ€Ð½Ð¸Ð»Ð°')).toMatch(/Ð·Ð²Ð°Ð» Ð´ÐµÐ´ÐºÐ° Ñ‡ÐµÑ€Ð½Ð¸Ð»Ð°/i);
    });

    test('Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°ÐµÑ‚ Ð§Ð¸Ð¿Ð¾Ð»Ð»Ð¸Ð½Ð¾', async () => {
        act('');
        expect(await act('Ð§Ð¸Ð¿Ð¾Ð»Ð»Ð¸Ð½Ð¾')).toMatch(/Ñ‡Ð¸Ð¿Ð¾Ð»Ð»Ð¸Ð½Ð¾ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ ÑÐºÐ»Ð¾Ð½ÑÐµÑ‚ Ð§Ñ‘Ñ€Ð½Ð¾Ð³Ð¾', async () => {
        act('');
        expect(await act('Ñ‡ÐµÑ€Ð½Ñ‹Ð¹')).toMatch(/Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
        expect(await act('Ñ‡ÐµÑ€Ð½Ñ‹Ð¹')).toMatch(/Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ Ð·Ð° Ñ‡ÐµÑ€Ð½Ð¾Ð³Ð¾/i);
    });

    test('Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°ÐµÑ‚ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¸Ð· Ð´Ð²ÑƒÐº ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…', async () => {
        act('');
        expect(await act('Ð±Ð°Ð±Ñƒ ÑÐ³Ñƒ')).toMatch(/Ð±Ð°Ð±Ð° ÑÐ³Ð° ðŸ§™â€ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
        expect(await act('Ð´ÐµÐ´Ð° Ð¼Ð¾Ñ€Ð¾Ð·Ð°')).toMatch(/Ð´ÐµÐ´ Ð¼Ð¾Ñ€Ð¾Ð· ðŸŽ… Ð·Ð° Ð±Ð°Ð±Ñƒ ÑÐ³Ñƒ/i);
        expect(await act('Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ° Ð¿Ð°ÑƒÐºÐ°')).toMatch(/Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ð¿Ð°ÑƒÐº Ð·Ð° Ð´ÐµÐ´Ð° Ð¼Ð¾Ñ€Ð¾Ð·Ð°/i);
        expect(await act('ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð½ Ð°Ð¼ÐµÑ€Ð¸ÐºÐ°')).toMatch(/ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð½ Ð°Ð¼ÐµÑ€Ð¸ÐºÐ° Ð·Ð° Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ° Ð¿Ð°ÑƒÐºÐ°/i);

        expect(await act('Ð´ÐµÐ´ Ð±Ð°Ð±Ñƒ')).toMatch(/Ð±Ð°Ð±Ð° ðŸ‘µ Ð·Ð° ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð½Ð° Ð°Ð¼ÐµÑ€Ð¸ÐºÑƒ/i);
        expect(await act('Ð±Ð°Ð±Ð° Ð´ÐµÐ´Ð° Ð´ÑƒÐ´ÐºÐ°')).toMatch(/Ð´ÐµÐ´ ðŸ‘´ Ð·Ð° Ð±Ð°Ð±Ñƒ/i);
        expect(await act('Ñ…Ð¾Ð»Ð¾Ð´ ÑÑ‚ÑƒÐ»')).toMatch(/Ð´Ð¾Ð»Ð³Ð¾ Ð·Ð²Ð°Ð» Ð´ÐµÐ´ Ñ…Ð¾Ð»Ð¾Ð´/i);
    });

    test('ÐÐµ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð´Ð²Ð° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð· Ñ€Ð°Ð·Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»Ð°', async () => {
        act('');
        expect(await act('Ð¡Ð¾Ð±Ð°ÐºÐ° ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹')).toMatch(/ÑÐ¾Ð±Ð°ÐºÐ° ðŸ¶ Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('ÐžÑ‚Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ Ð¡', async () => {
        act('');
        expect(await act('Ð”ÑƒÑ€Ð°Ñ‡ÐºÐ° Ñ Ð¿ÐµÑ€ÐµÑƒÐ»Ð¾Ñ‡ÐºÐ°')).toMatch(/Ð´ÑƒÑ€Ð°Ñ‡Ð¾Ðº Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('ÐžÑ‚Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÐµÐ½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÑÐ»Ð¾Ð²Ð° (Ñ‚Ð°ÐºÐ¾Ðµ ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾ Ð±Ñ‹Ð²Ð°ÐµÑ‚)', async () => {
        act('');
        expect(await act('Ð§ÐµÐ±ÑƒÑ€Ð°ÑˆÐºÑƒ Ñ‡ÐµÐ±ÑƒÑ€Ð°ÑˆÐºÑƒ')).toMatch(/^Ð§ÐµÐ±ÑƒÑ€Ð°ÑˆÐºÐ° Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð² Ð”Ð° Ð¸ ÐÐµÑ‚ Ð½Ðµ Ñ‡ÑƒÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñƒ', async () => {
        act('');
        await act('ÐœÑ‹ÑˆÐºÑƒ');
        expect(await act('Ð”Ð°')).toMatch(/Ð¿Ð¾ÑÐ°Ð´Ð¸Ð» Ð´ÐµÐ´ Ñ€ÐµÐ¿ÐºÑƒ/i);
    });

    test.skip('ÐšÐ¾Ð³Ð´Ð° Ð·Ð¾Ð²ÑƒÑ‚ ÑÐµÐ±Ñ Ð½Ðµ Ð·Ð¾Ð²ÑƒÑ‚ Ð¼ÐµÐ½Ñ?', async () => {
        act('');
        expect(await act('Ð¼ÐµÐ½Ñ')).toMatch(/ÐºÑ‚Ð¾ Ð²Ñ‹/i);
    });

    test.skip('ÐŸÑ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð—Ð° Ð·Ð°Ð¹Ñ†ÐµÐ¼ (Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ñ)', async () => {
        act('');
        expect(await act('Ð·Ð° Ð·Ð°Ð¹Ñ†ÐµÐ¼')).toMatch(/Ð·Ð°ÑÑ† Ð·Ð° Ð´ÐµÐ´ÐºÑƒ/i);
    });

    test('Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ ÐºÐ¾Ð³Ð´Ð° ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑÑ Ð¾Ñ‡ÐµÐ½ÑŒ Ð´Ð»Ð¸Ð½Ð½Ð¾Ð¹', async () => {
        let tale = await tts('');

        while (tale.length < 1024 && !/Ð²Ñ‹Ñ‚ÑÐ½ÑƒÐ»Ð¸ Ñ€ÐµÐ¿ÐºÑƒ/i.test(tale)) {
            tale = await tts('Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¾Ð³Ð¾ ÐºÐ¾Ð½ÐµÐ½ÐºÐ°');
        }

        expect(tale).toMatch(/Ð²Ñ‹Ñ‚ÑÐ½ÑƒÐ»Ð¸ Ñ€ÐµÐ¿ÐºÑƒ/i);
    });

    test('Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÑ‚ ÑÐ¼Ð¾Ð´Ð¶Ð¸ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ', async () => {
        await tts('');
        expect(await tts('ðŸº Ð¡ÐµÑ€Ð¾Ð³Ð¾ Ð²Ð¾Ð»ÐºÐ°')).toMatch(/ÑÐµÑ€Ñ‹Ð¹ Ð²Ð¾Ð»Ðº/i);
    });

    test('Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ðµ Ð´ÐµÑ„ÐµÐºÑ€Ñ‹ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ Ñ€ÐµÑ‡Ð¸', async () => {
        await tts('');
        expect(await tts('ÐŸÐ¾Ð·Ð²Ð°Ð» ÑÑƒÑ‡ÐºÑƒ')).toMatch(/Ð¶ÑƒÑ‡ÐºÐ°/i);
    });

    test('ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ñ ÑƒÐ¶Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°Ð¼Ð¸ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾', async () => {
        const shown = {};

        // ÐŸÐµÑ€Ð²Ñ‹Ðµ Ñ‚Ñ€Ð¸ Ð²Ñ‹Ð·Ð¾Ð²Ð° ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð½Ðµ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´ÑÑ‚
        expect(await buttons('')).toEqual([]);
        expect(await buttons('ÐÐ½Ð´Ñ€ÐµÑ')).toEqual([]);
        expect(await buttons('ÐÐ½Ð´Ñ€ÐµÑ')).toEqual([]);

        let btns = await buttons('ÐÐ½Ð´Ñ€ÐµÑ');
        expect(btns).toHaveLength(2);

        do {
            const [first, second] = btns;

            expect(shown).not.toHaveProperty(first.text);
            second && expect(shown).not.toHaveProperty(second.text);

            shown[first.text] = true;
            btns = await buttons(first.text);
        } while (btns.length);
    });

    //#region tests infrastructure
    let killStemmer: () => void;
    let stemmer: Stemmer;
    let sessionData: SessionData;

    async function act(command: string, random100 = 0): Promise<string> {
        const {
            speech: { text },
        } = await mainDialog(command, sessionData, { stemmer, random100 });
        return text;
    }

    async function tts(command: string, random100 = 0): Promise<string> {
        const {
            speech: { tts },
        } = await mainDialog(command, sessionData, { stemmer, random100 });
        return tts;
    }

    async function buttons(command: string, random100 = 0) {
        const {
            buttons,
            speech: { text },
        } = await mainDialog(command, sessionData, { stemmer, random100 });
        return buttons;
    }

    beforeEach(() => {
        sessionData = createSessionData();
    });

    beforeAll(() => {
        const spawned = spawnMystem();
        stemmer = spawned.stemmer;
        killStemmer = spawned.killStemmer;
    });

    afterAll(() => killStemmer());
    //#endregion
});
